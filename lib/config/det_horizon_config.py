model_cfg = dict(
    class_list=('__background__', 'SL', 'SLL', 'SLB', 'SLD', 'SLK',
                'SQ', 'SLQ', 'YHS', 'KP', 'WQ', 'FC', 'KT', 'JD'),
    defect_class_list=('SL', 'SLL', 'SLB', 'SLD', 'SLK',
                       'SQ', 'SLQ', 'YHS', 'KP', 'WQ'),
    rename_class_list={
        'KT': ['KT', 'KZ', 'YJ', 'JJ', 'DJ', 'KQ', 'JG', 'MK'],
        'KP': ['KP1'],
    },
    confidence_per_cls={'SL': [0.1], 'SLL': [0.43], 'SLB': [1.0], 'SLD': [0.38], 'SLK': [0.32], 'SQ': [
        0.17], 'SLQ': [1.0], 'YHS': [0.59], 'KP': [0.78], 'WQ': [0.46], 'FC': [0.93], 'KT': [0.66], 'JD': [0.18]},
    ANCHOR_SCALES=[1.2, 2.5, 6, 10, 14, 20, 40],
    # [0.333, 0.5, 0.667, 1, 1.5, 2, 3],
    # [0.09, 0.133, 0.333, 0.5, 0.667, 1.0, 1.5, 2.0, 3, 7.5, 11],
    #ANCHOR_RATIOS=[0.333, 0.5, 0.667, 1, 1.5, 2, 3],
    #ANCHOR_RATIOS=[0.09, 0.133, 0.333, 0.5, 0.667, 1.0, 1.5, 2.0, 3, 7.5, 11],
    ANCHOR_RATIOS=[0.333, 0.5, 0.667, 1.0, 1.5, 2.0, 3.0],
    POOLING_MODE='align',
    POOLING_SIZE=7,
    FEAT_STRIDE=[8],

    # "save_models/horizon_defect_0723_0022.ckpt",
    model="save_models/horizon_defect_0723_0430.ckpt",
    save_model_interval=1,

    MODEL=dict(
        RCNN_CIN=768,
        RPN_CIN=256,
        RCNN_LAST=4096,
        BACKBONE='shortlitehyper',
        DOUT_BASE_MODEL=336,
    ),

    TRAIN=dict(
        dataset="xml",
        train_path="/data0/datasets/det_horizon_defect/1/original",
        val_path=None,
        save_dir="/data/models/",
        resume_model=None,
        # resume_model="save_models/horizon_defect_0723_0022.ckpt",
        model_name="horizon_defect_0723_",
        gpus=(1, 2, ),
        #gpus=(0, 1, 2, ),
        batch_size_per_gpu=24,
        epochs=1000,
        num_works=8,
        LEARNING_RATE=0.00001,
        MOMENTUM=0.9,
        WEIGHT_DECAY=0.0005,
        BATCH_SIZE=128,
        FG_FRACTION=0.25,
        FG_THRESH=0.5,
        BG_THRESH_HI=0.5,
        BG_THRESH_LO=0.0,
        RPN_POSITIVE_OVERLAP=0.7,
        RPN_NEGATIVE_OVERLAP=0.3,
        RPN_FG_FRACTION=0.5,
        RPN_BATCHSIZE=256,
        RPN_NMS_THRESH=0.7,
        RPN_PRE_NMS_TOP_N=12000,
        RPN_POST_NMS_TOP_N=2000,
        RPN_BBOX_INSIDE_WEIGHTS=(1.0, 1.0, 1.0, 1.0),
        TRUNCATED=False,
        BBOX_NORMALIZE_MEANS=(0.0, 0.0, 0.0, 0.0),
        BBOX_NORMALIZE_STDS=(0.1, 0.1, 0.2, 0.2),
        BBOX_INSIDE_WEIGHTS=(1.0, 1.0, 1.0, 1.0),
        RPN_MIN_SIZE=8,
        RPN_CLOBBER_POSITIVES=False,
        RPN_POSITIVE_WEIGHT=-1.0,
        BBOX_NORMALIZE_TARGETS_PRECOMPUTED=True,

    ),

    TEST=dict(
        img_path="/data0/datasets/det_horizon_defect/1/original",
        # /data1/3-组图分割/online-4M-0719-seg/horizon /data1/3-组图分割/online-4M-0722-seg/horizon
        # img_path="/data1/3-组图分割/online-4M-0722-seg/horizon",
        save_dir="/data/zhangcc/data/tmp/test_results/",
        gpus=(1, ),
        SCALES=(600,),
        MAX_SIZE=6400,
        TEST_SCALE=160,
        SCALE_MULTIPLE_OF=32,
        iou_thresh=0.5,
        nms_thresh=0.25,
        thresh=0.8,
        small_object_size=0,
        RPN_PRE_NMS_TOP_N=6000,
        RPN_POST_NMS_TOP_N=300,
        RPN_NMS_THRESH=0.7,
        RPN_MIN_SIZE=8,
        gama=False,
    ),
)
